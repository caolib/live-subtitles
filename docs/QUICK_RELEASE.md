# 快速发布指南

## 发布新版本的步骤

### 1. 运行发布脚本

```powershell
.\release.ps1
```

### 2. 选择版本类型

脚本会显示交互式菜单，使用 ↑↓ 键选择：

```
当前最新的标签: 0.1.0
选择版本类型 (当前: 0.1.0)

→ 0.1.1 (补丁版本 - bug修复)
  0.2.0 (次要版本 - 新功能)
  1.0.0 (主要版本 - 重大更新)
  手动输入版本号

使用 ↑↓ 键选择，Enter 确认，Esc 取消
```

### 3. 编辑发布说明

脚本会打开 `docs/RELEASE.md`，编辑更新内容：

```markdown
## 版本 0.1.1

### 更新内容

- 添加了自动更新检查功能
- 改进了字幕显示效果

### 修复

- 修复了模型切换时的崩溃问题
- 修复了设置窗口无法打开的问题
```

编辑完成后保存，回到终端按 Enter 继续。

### 4. 等待自动构建

推送完成后：

1. 访问 https://github.com/caolib/live-subtitles/actions
2. 查看 "发布应用" 工作流
3. 等待约 10-15 分钟

### 5. 验证发布

构建成功后，访问 https://github.com/caolib/live-subtitles/releases

检查新版本是否包含：
- ✅ MSI 安装包 (`.msi`)
- ✅ EXE 安装包 (`.exe`)
- ✅ 签名文件 (`.sig`)
- ✅ 更新配置 (`latest.json`)

## 版本类型说明

| 类型 | 示例 | 适用场景 |
|-----|------|---------|
| 补丁 (Patch) | 0.1.0 → 0.1.1 | bug 修复、小改进 |
| 次要 (Minor) | 0.1.0 → 0.2.0 | 新功能、较大改进 |
| 主要 (Major) | 0.1.0 → 1.0.0 | 重大更新、不兼容变更 |

## 常见问题

### 发布失败怎么办？

1. 检查 GitHub Actions 日志
2. 删除错误的标签：
   ```powershell
   git tag -d 0.1.1
   git push origin :refs/tags/0.1.1
   ```
3. 重新运行脚本

### 如何跳过某个步骤？

脚本是全自动的，无法跳过。如需手动控制，请参考 [RELEASE_GUIDE.md](RELEASE_GUIDE.md) 中的手动发布方案。

### 构建时间太长？

正常情况下需要 10-15 分钟，主要耗时：
- Rust 依赖编译（首次较慢，后续有缓存）
- 前端资源打包
- 安装包生成和签名

## 注意事项

- ⚠️ 发布前确保代码已测试
- ⚠️ 发布说明要清晰明了
- ⚠️ 不要频繁发布（合并多个更新）
- ⚠️ 主版本更新前充分测试

## 下一步

成功发布后：
1. 在旧版本应用中测试自动更新
2. 检查下载链接是否正常
3. 向用户宣布新版本发布
